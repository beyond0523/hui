<!DOCTYPE html><html><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no"><title></title><script src="../js/mui.min.js"></script><script src="https://cdn.wilddog.com/js/client/current/wilddog.js"></script><link href="../css/mui.min.css" rel="stylesheet"><script charset="utf-8">mui.init()</script><style>.title{background-color:rgba(0,0,0,.25);font-weight:400}#list td{padding:5px 5px}#list tr:active{background-color:rgba(0,0,0,.25)}#popover{min-width:282px;height:300px;top:50%!important;margin-top:-150px;left:50%!important;margin-left:-141px}@media (min-width:400px){#popover{width:80%;margin-left:-40%}}.mui-popover .mui-popover-arrow{display:none!important}.operate{text-align:center;margin-top:20px}</style></head><body><header class="mui-bar mui-bar-nav"><a class="mui-action-back mui-icon mui-icon-left-nav mui-pull-left"></a> <a class="mui-icon mui-icon-plusempty mui-pull-right" id="open"></a><h1 class="mui-title">cloud DB（云端数据库）</h1></header><div class="mui-content"><div class="mui-content-padded"><p style="text-indent:22px">这是mui无后端开发示例，集成野狗云服务，通过js操作云端数据库，实现常见的增删改查功能。</p></div><div style="background-color:#fff;padding-bottom:15px"><div class="mui-content-padded"><h4 style="text-align:center;margin-bottom:15px;padding-top:15px">云端数据库</h4><table id="list" border="1" width="100%" style="padding:5px 10px;text-align:center"></table></div></div></div><div id="popover" class="mui-popover"><div class="mui-popover-arrow"></div><div class="mui-content-padded"><h4 id="title" style="text-align:center;margin-top:20px">新增数据</h4><form class="mui-input-group" style="margin-top:30px"><div class="mui-input-row"><label>字段1：</label><input type="text" class="mui-input-clear" id="col1" placeholder="请输入"></div><div class="mui-input-row"><label>字段2：</label><input type="text" class="mui-input-clear" id="col2" placeholder="请输入"></div><div class="mui-input-row"><label>字段3：</label><input type="text" class="mui-input-clear" id="col3" placeholder="请输入"></div></form><div id="add_div" class="operate mui-hidden"><button type="button" class="mui-btn mui-btn-blue" id="add">确定</button></div><div id="edit_div" class="operate mui-hidden"><button type="button" class="mui-btn mui-btn-blue" id="update" style="margin-right:30px">修改</button> <button type="button" class="mui-btn mui-btn-red" id="del">删除</button></div></div></div><script>function trim(e){return e.replace(/(^\s*)|(\s*$)/g,"")}function getList(){ref.once("value",function(e){list.innerHTML="<tr class='title'><td>字段1</td><td>字段2</td><td>字段3</td></tr>";var t=e.val();mui.each(t,function(e,t){var i=document.createElement("tr");i.setAttribute("id",e);var d=document.createElement("td");d.className="col1",d.innerHTML=t.col1,i.appendChild(d);var n=document.createElement("td");n.className="col2",n.innerHTML=t.col2,i.appendChild(n);var o=document.createElement("td");o.className="col3",o.innerHTML=t.col3,i.appendChild(o),list.appendChild(i)})})}var network=!1,ref=null;mui.plusReady(function(){plus.networkinfo.getCurrentType()==plus.networkinfo.CONNECTION_NONE?mui.toast("当前网络不给力，无法连接云端数据库~"):(network=!0,ref=new Wilddog("https://muidemo.wilddogio.com/demo"),getList())});var list=document.getElementById("list"),col1=document.getElementById("col1"),col2=document.getElementById("col2"),col3=document.getElementById("col3"),add_div=document.getElementById("add_div"),edit_div=document.getElementById("edit_div"),title=document.getElementById("title");document.getElementById("open").addEventListener("tap",function(){network?(col1.value="",col2.value="",col3.value="",title.innerHTML="新增数据",add_div.classList.remove("mui-hidden"),edit_div.classList.contains("mui-hidden")||edit_div.classList.add("mui-hidden"),mui("#popover").popover("toggle")):mui.toast("当前网络不给力，请稍后再试")}),document.getElementById("add").addEventListener("tap",function(){if(ref){var e=!0;if(mui(".mui-input-group input").each(function(){if(!this.value||""==trim(this.value)){var t=this.previousElementSibling;return mui.alert(t.innerText+"不允许为空"),e=!1,!1}}),e){ref.push({col1:col1.value,col2:col2.value,col3:col3.value});add_div.classList.add("mui-hidden"),mui("#popover").popover("toggle"),mui.toast("添加成功~"),getList()}}else mui.toast("当前网络不给力，请稍后再试")}),document.getElementById("update").addEventListener("tap",function(){var e=!0;if(mui(".mui-input-group input").each(function(){if(!this.value||""==trim(this.value)){var t=this.previousElementSibling;return mui.alert(t.innerText+"不允许为空"),e=!1,!1}}),e){var t=ref.child(document.getElementById("col1").getAttribute("demoid"));t.update({col1:col1.value,col2:col2.value,col3:col3.value}),mui("#popover").popover("toggle"),edit_div.classList.add("mui-hidden"),mui.toast("修改成功~"),getList()}}),document.getElementById("del").addEventListener("tap",function(){var e=ref.child(document.getElementById("col1").getAttribute("demoid"));e.remove(),mui("#popover").popover("toggle"),edit_div.classList.contains("mui-hidden")||edit_div.classList.add("mui-hidden"),mui.toast("删除成功~"),getList()}),mui("#list").on("tap","tr",function(){var e=this.getAttribute("id");e&&(document.getElementById("col1").value=this.querySelector(".col1").innerHTML,document.getElementById("col2").value=this.querySelector(".col2").innerHTML,document.getElementById("col3").value=this.querySelector(".col3").innerHTML,document.getElementById("col1").setAttribute("demoid",e),title.innerHTML="编辑数据",add_div.classList.contains("mui-hidden")||add_div.classList.add("mui-hidden"),edit_div.classList.remove("mui-hidden"),mui("#popover").popover("toggle"))})</script></body></html>